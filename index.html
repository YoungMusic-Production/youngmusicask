<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>YOUNG MUSIC | åŒ å¿ƒåŸåˆ›å•†åŠ¡å®šåˆ¶</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        :root { --primary: #a855f7; --bg: #050505; --accent: #d4af37; }
        body { background-color: var(--bg); color: #e5e5e5; font-family: -apple-system, sans-serif; height: 100vh; overflow: hidden; }
        .bubble { max-width: 85%; padding: 14px 18px; border-radius: 20px; font-size: 14px; line-height: 1.6; margin-bottom: 12px; animation: slideUp 0.3s ease-out; }
        .bubble-ai { background: #1a1a1c; color: #d4d4d8; border-bottom-left-radius: 4px; border: 1px solid #333; }
        .bubble-user { background: var(--primary); color: white; border-bottom-right-radius: 4px; align-self: flex-end; }
        .opt-btn { background: #18181b; border: 1px solid #27272a; padding: 12px; border-radius: 12px; font-size: 13px; cursor: pointer; transition: all 0.2s; color: #a1a1aa; text-align: left; }
        .opt-btn:hover { background: var(--primary); border-color: white; color: white; transform: translateY(-2px); }
        .nav-btn { font-size: 10px; border: 1px solid rgba(255,255,255,0.1); padding: 4px 10px; border-radius: 99px; color: #666; }
        .nav-btn.active { color: #fff; border-color: rgba(255,255,255,0.3); }
        #modal-overlay, #qr-overlay { background: rgba(0,0,0,0.97); backdrop-filter: blur(20px); }
        .ticket-bg { background: #000; border: 1px solid #333; box-shadow: 0 0 50px rgba(168,85,247,0.25); }
        .logo-glow { filter: drop-shadow(0 0 5px rgba(212,175,55,0.3)); transition: all 0.5s; }
        .logo-glow:hover { filter: drop-shadow(0 0 10px rgba(212,175,55,0.5)); }
        @keyframes slideUp { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="flex justify-center items-center p-4">

    <div class="w-full max-w-5xl h-[95vh] flex gap-6">
        <div class="flex-1 flex flex-col bg-neutral-900 rounded-3xl border border-white/10 overflow-hidden shadow-2xl relative">
            <div class="p-4 border-b border-white/5 flex items-center justify-between bg-black/40">
                <div class="flex items-center gap-4">
                    <img src="logo.jpg" class="w-14 h-14 object-contain logo-glow" onerror="this.src='https://api.iconify.design/material-symbols:music-note-rounded.svg?color=%23a855f7'">
                    <div>
                        <h2 class="font-bold text-base text-white tracking-widest uppercase">YOUNG MUSIC</h2>
                        <p class="text-[9px] text-purple-400 font-mono italic uppercase tracking-tighter">Professional Custom Production</p>
                    </div>
                </div>
                <div class="flex gap-2">
                    <button id="undo-btn" onclick="undo()" class="nav-btn">â†© æ’¤é”€</button>
                    <button id="redo-btn" onclick="redo()" class="nav-btn">å‰è¿› â†ª</button>
                </div>
            </div>

            <div id="chat-box" class="flex-1 overflow-y-auto p-5 flex flex-col space-y-4"></div>
            
            <div id="options-container" class="px-5 py-4 bg-black/40 border-t border-white/5">
                <div id="options-area" class="grid grid-cols-2 md:grid-cols-3 gap-2.5 max-h-[220px] overflow-y-auto"></div>
            </div>

            <div class="p-4 bg-black/30 border-t border-white/5">
                <form onsubmit="handleManual(event)" class="flex gap-2">
                    <input id="user-input" type="text" placeholder="æè¿°ç»†èŠ‚æˆ–è¾“å…¥å¯¹æ ‡æ¡ˆä¾‹..." class="flex-1 bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-sm focus:outline-none focus:border-purple-500 text-white transition-all">
                    <button type="submit" class="bg-purple-600 hover:bg-purple-500 text-white font-bold px-6 rounded-xl text-sm transition-all">ç¡®è®¤</button>
                </form>
            </div>
        </div>
    </div>

    <div id="modal-overlay" class="fixed inset-0 z-50 hidden flex items-center justify-center p-4">
        <div class="flex flex-col items-center gap-6">
            <div id="final-sheet" class="ticket-bg w-[400px] p-10 text-white rounded-sm text-center">
                <img src="logo.jpg" class="w-28 h-28 mx-auto mb-4 object-contain logo-glow">
                <div class="font-black text-2xl tracking-tighter border-y border-white/20 py-2 w-full mb-6 uppercase">å®šåˆ¶é¡¹ç›®æ„å‘ç¡®è®¤å•</div>
                
                <div class="space-y-4 text-left text-xs px-2">
                    <div class="flex justify-between items-center border-b border-white/5 pb-1">
                        <span class="text-[8px] text-gray-500 uppercase">Track ID</span>
                        <span class="font-mono text-[10px] text-purple-400">#<span id="sheet-id"></span></span>
                    </div>
                    <div><p class="text-[8px] text-purple-400 uppercase mb-1">åˆ¶ä½œæ¨¡å¼ & æ›²é£é£æ ¼</p><p id="s-mode-vibe" class="font-bold text-sm"></p></div>
                    <div class="p-3 bg-white/5 rounded border border-white/10 italic"><p id="s-ref" class="text-[11px] leading-relaxed"></p></div>
                    <div class="grid grid-cols-2 gap-4 py-2 border-y border-white/5">
                        <div><p class="text-[8px] text-gray-500">è§„æ ¼/æˆæƒ</p><p id="s-misc" class="font-bold text-[10px]"></p></div>
                        <div><p class="text-[8px] text-gray-500">ä¿®æ”¹ä¿éšœ</p><p id="s-revisions" class="font-bold text-[10px]"></p></div>
                    </div>
                    <div class="p-4 bg-purple-900/20 border-l-4 border-purple-600">
                        <p class="text-[8px] text-purple-400 mb-0.5">é¢„ä¼°å•†åŠ¡é¢„ç®—</p>
                        <p id="s-budget" class="text-xl font-black"></p>
                    </div>
                </div>
                <div class="mt-8 text-[8px] opacity-20 italic">YOUNG MUSIC PRODUCTION STUDIO</div>
            </div>
            
            <div class="flex gap-3">
                <button onclick="download()" class="px-6 py-3 bg-neutral-800 text-white rounded-full text-sm">ğŸ’¾ ä¿å­˜å•æ®</button>
                <button onclick="sendEmail()" class="px-6 py-3 bg-purple-600 text-white font-bold rounded-full text-sm">ğŸ“§ æäº¤æ„å‘</button>
                <button onclick="toggleQR(true)" class="px-6 py-3 bg-white text-black font-bold rounded-full text-sm">ğŸ“¢ æ¨èå¥½å‹</button>
            </div>
        </div>
    </div>

    <div id="qr-overlay" class="fixed inset-0 z-[100] hidden flex items-center justify-center p-4">
        <div class="bg-neutral-900 p-8 rounded-3xl border border-white/10 flex flex-col items-center gap-5 text-center">
            <h3 class="font-bold text-purple-400 text-sm">åˆ†äº« YOUNG MUSIC</h3>
            <div class="bg-white p-3 rounded-xl">
                <img src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=https://youngmusic-production.github.io/youngmusicask/" class="w-44 h-44">
            </div>
            <p class="text-[10px] text-gray-400">é•¿æŒ‰ä¿å­˜äºŒç»´ç <br>æˆ–å‘é€ç»™åˆä½œä¼™ä¼´</p>
            <button onclick="toggleQR(false)" class="mt-2 text-gray-500 text-xs">ç‚¹å‡»å…³é—­</button>
        </div>
    </div>

    <script>
        let step = 0; let answers = []; let redoStack = [];
        const config = { sheetId: Math.floor(Math.random()*90000 + 10000) };
        const myEmail = "tingyangmusic@qq.com";
        const box = document.getElementById('chat-box');
        const optArea = document.getElementById('options-area');
        const input = document.getElementById('user-input');

        const scenarios = [
            { q: "æ‚¨å¥½ï¼Œæ¬¢è¿æ¥åˆ° **YOUNG MUSIC**ã€‚è¯·é€‰æ‹©æœ¬æ¬¡ä½œå“çš„åˆ¶ä½œæ¨¡å¼ï¼š", opts: ["ğŸ¨ åŒ å¿ƒÂ·å…¨æ‰‹å·¥åˆ›ä½œ", "âš¡ AI æ™ºèƒ½è¾…åŠ©åˆ¶ä½œ", "âŒ¨ï¸ æ‰‹åŠ¨è¾“å…¥éœ€æ±‚"] },
            { q: "è¯·é€‰æ‹©æ‚¨å¿ƒä»ªçš„åˆ›ä½œæ›²é£å®šä½ï¼š", opts: ["ğŸ¤ æµè¡Œ (Pop)", "ğŸ¹ æŠ’æƒ…", "ğŸ§ å˜»å“ˆ", "ğŸ”¥ æ‘‡æ»š", "ğŸ•º ç”µå­", "ğŸ® å›½é£", "ğŸ» ç®¡å¼¦", "ğŸ™ æ°›å›´", "ğŸ¸ æ°‘è°£", "âŒ¨ï¸ æ‰‹åŠ¨"] },
            { q: "æ˜¯å¦æœ‰å¯¹æ ‡æ¡ˆä¾‹ (Reference)ï¼Ÿ", opts: ["âœï¸ æ‰‹åŠ¨å¡«å†™å‚è€ƒ", "ğŸ” æš‚æ— å¯¹æ ‡"] },
            { q: "ä½œå“çš„æ—¶é•¿è§„æ ¼ï¼š", opts: ["30s å•†ä¸šç‰‡æ®µ", "2min ç²¾ç®€ç‰ˆ", "3:30 æ ‡å‡†å®Œæ•´ç‰ˆ", "âŒ¨ï¸ è‡ªå®šä¹‰"] },
            { q: "å®å½•åŠè‰ºæœ¯é…ç½®ï¼š", opts: ["ğŸ¹ MIDI åˆ›ä½œ", "ğŸ¸ ä¹å™¨å®å½•", "ğŸ» å¤§å¸ˆçº§ç¼–åˆ¶", "âŒ¨ï¸ å¤‡æ³¨è¦æ±‚"] },
            { q: "é¢„è®¾çš„ä¿®æ”¹ä¿éšœæ¬¡æ•°ï¼Ÿ", opts: ["1æ¬¡ ä¿®æ­£", "2-3æ¬¡ æ ‡å‡†ç»´æŠ¤", "âœï¸ è‡ªå®šä¹‰"] },
            { q: "å…³äºä½œå“æƒç›Šæˆæƒæ–¹æ¡ˆï¼š", opts: ["ğŸ‘‘ ç‰ˆæƒä¹°æ–­", "ğŸ¤ éä¹°æ–­æˆæƒ", "âŒ¨ï¸ å¦è¡Œåå•†"] },
            { q: "æœ€åï¼Œè¯·ç¡®å®šæ‚¨çš„å•†åŠ¡é¢„ç®—æ¡£ä½ï¼š", opts: ["ğŸ’° Â¥500", "ğŸ’ Â¥3000", "ğŸ† Â¥10000+", "âŒ¨ï¸ å¦è¡Œé¢è°ˆ"] }
        ];

        window.onload = () => { document.getElementById('sheet-id').innerText = config.sheetId; refreshUI(); };
